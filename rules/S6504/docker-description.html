<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Ownership of an executable has been assigned to a user other than root. More
often than not, resource owners have write permissions and thus can edit the
resource.</p>
</div>
<div class="paragraph">
<p>Write permissions enable malicious actors, who got a foothold on the container,
to tamper with the executable and thus manipulate the container&#8217;s expected behavior.<br>
Manipulating executables could disrupt services or aid in escalating privileges
inside the container.<br></p>
</div>
<div class="paragraph">
<p>This breaches the container immutability principle as it facilitates container
changes during its life. Immutability, a container best practice, allows for a
more reliable and reproducible behavior of Docker containers.</p>
</div>
<div class="paragraph">
<p>Resource ownership is not required; executables can be assigned execute
permissions using <code>chmod</code> if needed.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ask_yourself_whether">Ask Yourself Whether</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>A non-root user has write permissions for the executable.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>There is a risk if you answered yes to the question.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_recommended_secure_coding_practices">Recommended Secure Coding Practices</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Use <code>--chmod</code> to change executable permissions at build-time.</p>
</li>
<li>
<p>Be mindful of the container immutability principle.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sensitive_code_example">Sensitive Code Example</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-docker" data-lang="docker">FROM example

RUN useradd exampleuser
# Sensitive
COPY --chown=exampleuser:exampleuser src.py dst.py</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compliant_solution">Compliant Solution</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-docker" data-lang="docker">FROM example

COPY src.py dst.py</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_see">See</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.docker.com/engine/reference/builder/#add">Dockerfile reference</a> - ADD instruction</p>
</li>
<li>
<p><a href="https://docs.docker.com/engine/reference/builder/#copy">Dockerfile reference</a> - COPY instruction</p>
</li>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/732.html">MITRE, CWE-732</a> - Incorrect Permission Assignment for Critical Resource</p>
</li>
<li>
<p><a href="https://cloud.google.com/architecture/best-practices-for-operating-containers#immutability">Google Cloud, Immutability</a> - Best practices for operating containers</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Make sure no write permissions are assigned to the executable.</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>Highlight the executable name as primary location and the chown flag/command as secondary location.</p>
</div>
<hr>
</div>
</div>
</div>