<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Variable references should be encapsulated with double quotes to avoid globbing and word splitting.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Within the command, variable references and command substitutions go through word splitting and pathname expansion (globbing).</p>
</div>
<div class="paragraph">
<p>This causes issues if the variable contains whitespaces or shell pathname expansion (glob) characters like <code>*</code>.</p>
</div>
<div class="sect2">
<h3 id="_what_is_the_potential_impact">What is the potential impact?</h3>
<div class="paragraph">
<p>This issue can lead to bugs if the variable contains sensitive characters, which may not be interpreted correctly.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_fix_it">How to fix it</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Add the missing double quotes to this variable.</p>
</div>
<div class="sect2">
<h3 id="_code_examples">Code examples</h3>
<div class="sect3">
<h4 id="_noncompliant_code_example">Noncompliant code example</h4>
<div class="paragraph">
<p>Demonstration of pathname expansion using the <code>echo</code> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-docker" data-lang="docker">RUN test="command t*.sh"
RUN echo $test</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will print <code>"command temp1.sh temp2.sh"</code>, as <code>*</code> is substituted to matching files in the current folder.
In this example the folder contains the files <code>temp1.sh</code> and <code>temp2.sh</code>.</p>
</div>
<div class="paragraph">
<p>Demonstration of word splitting using the <code>echo</code> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-docker" data-lang="docker">RUN test=" Hello World "
RUN echo $test</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will print <code>"Hello World"</code>, omitting the leading and trailing whitespaces.</p>
</div>
</div>
<div class="sect3">
<h4 id="_compliant_solution">Compliant solution</h4>
<div class="paragraph">
<p>Demonstration of pathname expansion using the <code>echo</code> command, which will print <code>"command t*.sh"</code> as intended:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-docker" data-lang="docker">RUN test="command t*.sh"
RUN echo "$test"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Demonstration of word splitting using the <code>echo</code> command, which will print <code>" Hello World "</code> as intended:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-docker" data-lang="docker">RUN test=" Hello World "
RUN echo "$test"</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_documentation">Documentation</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://tldp.org/LDP/abs/html/globbingref.html">Linux Documentation Project - Globbing</a></p>
</li>
<li>
<p><a href="https://dwheeler.com/essays/filenames-in-shell.html#doublequote">Filenames and Pathnames in Shell: How to do it Correctly</a></p>
</li>
</ul>
</div>
<hr>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Add the missing double quotes to this variable, as it can lead to unexpected behaviour.</p>
</div>
</div>
<div class="sect2">
<h3 id="_highlighting">Highlighting</h3>
<div class="paragraph">
<p>Highlight the entire command which is using unquoted variables.</p>
</div>
<hr>
</div>
</div>
</div>