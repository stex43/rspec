<div class="sect1">
<h2 id="_description">Description</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_why_is_this_an_issue">Why is this an issue?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Once an Android component has been exported, it can be used by attackers to
launch malicious actions and might also give access to other components
that are not exported.</p>
</div>
<div class="paragraph">
<p>As a result, sensitive user data can be stolen, and components can be launched
unexpectedly.</p>
</div>
<div class="paragraph">
<p>For this reason, the following components should be protected:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Providers</p>
</li>
<li>
<p>Activities</p>
</li>
<li>
<p>Activity-aliases</p>
</li>
<li>
<p>Services</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To do so, it is recommended to either set <code>exported</code> to <code>false</code>, add
<code>android:readPermission</code> and <code>android:writePermission</code> attributes, or add a
<code>&lt;permission&gt;</code> tag.</p>
</div>
<div class="paragraph">
<p><strong>Warning</strong>: When targeting AndroidÂ versions lower than 12, the presence of intent filters will cause <code>exported</code> to be set to
<code>true</code> by default.</p>
</div>
<div class="paragraph">
<p>If a component must be exported, use a <code>&lt;permission&gt;</code> tag and the
<a href="https://developer.android.com/guide/topics/manifest/permission-element#plevel">protection level</a>
that matches your use case and data confidentiality requirements.<br>
For example, <a href="https://developer.android.com/training/sync-adapters">Sync adapters</a>
should use a <code>signature</code> protection level to remain both exported <strong>and</strong> protected.</p>
</div>
<div class="sect2">
<h3 id="_noncompliant_code_example">Noncompliant code example</h3>
<div class="paragraph">
<p>The following components are vulnerable because permissions are undefined or
partially defined:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;provider
  android:authorities="com.example.app.Provider"
  android:name="com.example.app.Provider"
  android:exported="true"
  android:readPermission="com.example.app.READ_PERMISSION" /&gt;  &lt;!-- Noncompliant: write permission is not defined --&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;provider
  android:authorities="com.example.app.Provider"
  android:name="com.example.app.Provider"
  android:exported="true"
  android:writePermission="com.example.app.WRITE_PERMISSION" /&gt;  &lt;!-- Noncompliant: read permission is not defined --&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;activity android:name="com.example.activity.Activity"&gt;  &lt;!-- Noncompliant: permissions are not defined --&gt;
  &lt;intent-filter&gt;
    &lt;action android:name="com.example.OPEN_UI"/&gt;
    &lt;category android:name="android.intent.category.DEFAULT"/&gt;
  &lt;/intent-filter&gt;
&lt;/activity&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_compliant_solution">Compliant solution</h3>
<div class="paragraph">
<p>If the component&#8217;s capabilities or data are not intended to be shared with
other apps, its <code>exported</code> attribute should be set to <code>false</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;provider
  android:authorities="com.example.app.Provider"
  android:name="com.example.app.Provider"
  android:exported="false" /&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Otherwise, implement permissions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;provider
  android:authorities="com.example.app.Provider"
  android:name="com.example.app.Provider"
  android:exported="true"
  android:readPermission="com.example.app.READ_PERMISSION"
  android:writePermission="com.example.app.WRITE_PERMISSION" /&gt;

&lt;activity android:name="com.example.activity.Activity"
          android:permission="com.example.app.PERMISSION" &gt;
  &lt;intent-filter&gt;
    &lt;action android:name="com.example.OPEN_UI"/&gt;
    &lt;category android:name="android.intent.category.DEFAULT" /&gt;
  &lt;/intent-filter&gt;
&lt;/activity&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://developer.android.com/guide/topics/providers/content-provider-creating#Permissions">developer.android.com</a> - Implementing content provider permissions</p>
</li>
<li>
<p><a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x11-v6-interaction_with_the_environment">Mobile AppSec Verification Standard</a> - Platform Interaction Requirements</p>
</li>
<li>
<p><a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m1-improper-platform-usage">OWASP Mobile Top 10 2016 Category M1</a> - Improper platform usage</p>
</li>
<li>
<p><a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m2-insecure-data-storage">OWASP Mobile Top 10 2016 Category M2</a> - Insecure Data Storage</p>
</li>
<li>
<p><a href="https://cwe.mitre.org/data/definitions/926">MITRE, CWE-926</a> - Improper Export of Android Application Components</p>
</li>
</ul>
</div>
<hr>
</div>
</div>
<div class="sect1">
<h2 id="_implementation_specification">Implementation Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(visible only on this page)</p>
</div>
<div class="sect2">
<h3 id="_message">Message</h3>
<div class="paragraph">
<p>Implement permissions on this exported component.</p>
</div>
</div>
</div>
</div>